<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>21&nbsp; Frequency Selective Filters in DT – Supplementary Notes for ECE 2714: Signals and Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./22-dft.html" rel="next">
<link href="./20-ct-filters.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7743ab93549fe57e350af7b50d1de34c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dd3f867a8242fdb793e0ec01cb489490.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Supplementary Notes for ECE 2714: Signals and Systems</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/clwyatt/notes-2714" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Supplementary-Notes-for-ECE-2714--Signals-and-Systems.epub" title="Download ePub" class="quarto-navigation-tool px-1" aria-label="Download ePub"><i class="bi bi-journal"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./21-dt-filters.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Frequency Selective Filters in DT</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Course Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ct-signals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Continuous-Time Signals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-dt-signals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Discrete-Time Signals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ct-lccde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">CT Systems as Linear Constant Coefficient Differential Equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-dt-lccde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">DT systems as linear constant coefficient difference equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-ct-lti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear Time Invariant CT Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-dt-lti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear Time Invariant DT Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-ct-conv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">CT Convolution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-dt-conv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">DT Convolution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ct-block.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CT Block Diagrams</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-dt-block.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DT Block Diagrams</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-ct-tf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Eigenfunctions of CT Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-dt-tf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Eigenfunctions of DT Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-ctfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">CT Fourier Series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-dtfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DT Fourier Series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-ctft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">CT Fourier Transform</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-dtft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">DT Fourier Transform</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-ct-fr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">CT Frequency Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-dt-fr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">DT Frequency Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-ct-filters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Frequency Selective Filters in CT</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-dt-filters.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Frequency Selective Filters in DT</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-dft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Discrete Fourier Transform</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sampling CT Signals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-recon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Reconstructing CT Signals</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-prereqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prerequisite Review</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-formulas-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Useful Mathematical Definitions and Tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./image-descriptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Detailed Image Descriptions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ideal-dt-filters" id="toc-ideal-dt-filters" class="nav-link active" data-scroll-target="#ideal-dt-filters"><span class="header-section-number">21.1</span> Ideal DT Filters</a></li>
  <li><a href="#practical-filters" id="toc-practical-filters" class="nav-link" data-scroll-target="#practical-filters"><span class="header-section-number">21.2</span> Practical Filters</a></li>
  <li><a href="#first-order-and-second-order-systems-as-filters" id="toc-first-order-and-second-order-systems-as-filters" class="nav-link" data-scroll-target="#first-order-and-second-order-systems-as-filters"><span class="header-section-number">21.3</span> First-order and second-order systems as filters</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Frequency Selective Filters in DT</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Recall the response of stable DT LTI systemsi to periodic inputs. Given a stable LTI system with frequency response <span class="math inline">\(H\left(e^{j\omega}\right)\)</span> the input-output relationship is</p>
<p><span class="math display">\[
x[n] = \sum\limits_{k = N_0}^{N_0 + N-1} a_k e^{jk\omega_0n} \longrightarrow y[n] = \sum\limits_{k = N_0}^{N_0 + N-1} a_k H\left(e^{jk\omega_0}\right) e^{jk\omega_0n}
\]</span></p>
<p>Note the output is equivalent to a signal with Fourier series coefficients <span class="math inline">\(b_k = a_k H\left(e^{jk\omega_0}\right)\)</span>. That is the Fourier coefficients are scaled by the frequency response at the harmonic frequency <span class="math inline">\(k\omega_0\)</span>.</p>
<p>Similarly for aperiodic signals, given a stable LTI system with frequency response <span class="math inline">\(H\left(e^{j\omega}\right)\)</span> the input-output relationship is <span class="math display">\[
x[n] = \frac{1}{2\pi} \int_{2\pi} X\left(e^{j\omega}\right) e^{j\omega n} \; d\omega \longrightarrow y[n] = \frac{1}{2\pi} \int_{2\pi} X\left(e^{j\omega}\right)H\left(e^{j\omega}\right) e^{j\omega n} \; d\omega
\]</span> Note the output is equivalent to a signal with DT Fourier Transform <span class="math inline">\(Y\left(e^{j\omega}\right) = X\left(e^{j\omega}\right) H\left(e^{j\omega}\right)\)</span>. That is the Fourier transform at each continuous frequency <span class="math inline">\(\omega\)</span> is scaled by the frequency response at that frequency.</p>
<p>As in CT, we can design the frequency response to modify the values of <span class="math inline">\(a_k\)</span> or <span class="math inline">\(X\left(e^{j\omega}\right)\)</span> selectively, passing them unmodified, increasing (amplifying) them, or decreasing (attenuating) them. Such systems are called DT filters (or more colloquially digital filters). As in CT there are 4 basic types:</p>
<ul>
<li>Low-pass Filters attenuate high frequencies while passing through lower frequencies. They are often used to reduce the effects of high-frequency noise in a signal.</li>
<li>High-pass Filters attenuate lower frequencies while passing through higher frequencies. They are used, for example, to select high-frequency audio components in high-end audio systems.</li>
<li>Bandpass Filters attenuate frequencies outside a band of frequencies. They can be viewed as a combination of a high-pass and low-pass filter. They are commonly used to select a range of frequencies for further processing and are central to many communication technologies.</li>
<li>Notch, Bandstop, or Stopband Filters attenuate frequencies inside an often narrow band of frequencies. Common applications are the removal of one or more corrupting signals mixed into another signal.</li>
</ul>
<p>While the design of such filters is outside the scope of this course, you are now equipped to understand and apply them based on your knowledge of the Fourier methods covered over the past several weeks. This is similar to CT filtering, with the important exception that the frequency domain is periodic in <span class="math inline">\(2\pi\)</span> for DT systems, so the filter frequency responses are periodic as well, with all the work being done in a range of frequencies from <span class="math inline">\((0,2\pi)\)</span> or equivalently from <span class="math inline">\((-\pi,\pi)\)</span>.</p>
<p>Digital filters have a number of advantages over CT filters and are widely used now in place of CT filters in audio, communication, and control applications. Audio (and video) in particular is now almost exclusively processed, stored, and transmitted digitally, converting to CT only at the point of an amplifier and speaker.</p>
<section id="ideal-dt-filters" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="ideal-dt-filters"><span class="header-section-number">21.1</span> Ideal DT Filters</h2>
<p>The above filter types each have an ideal form.</p>
<p>Low-pass filters remove frequency content above a threshold, <span class="math inline">\(\omega_c \in [0,\pi]\)</span>, called the . They have an ideal frequency response ,for any integer multiple <span class="math inline">\(k\)</span>, given by: <span class="math display">\[
H\left(e^{j\omega}\right) = \left\{ \begin{array}{lc}
  1 &amp; 2\pi k -\omega_c &lt; \omega &lt; 2\pi k + \omega_c\\
  0 &amp; \text{else}
\end{array}
\right.
\]</span> with magnitude and phase plot</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig21_1.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Illustration of the ideal lowpass DT filter frequency response.</figcaption>
</figure>
</div>
<p>As in CT filters, the range of frequencies <span class="math inline">\(-\omega_c \leq \omega \leq \omega_c\)</span> are called the pass-band. The range of frequencies outside the pass-band are called the stop-band.</p>
<p>High-pass filters remove frequency content below the cutoff frequency <span class="math inline">\(\omega_c\in [0,\pi]\)</span>. They have an ideal frequency response <span class="math display">\[
H\left(e^{j\omega}\right) = \left\{ \begin{array}{lc}
  0 &amp; 2\pi k -\omega_c &lt; \omega &lt; 2\pi k + \omega_c \\
  1 &amp; \text{else}
\end{array}
\right.
\]</span> with magnitude and phase plot</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig21_2.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Illustration of the ideal highpass DT filter frequency response.</figcaption>
</figure>
</div>
<p>Bandpass filters remove frequency content outside a band of frequencies called the pass-band. They have an ideal frequency response <span class="math display">\[
H\left(e^{j\omega}\right) = \left\{ \begin{array}{lc}
  1 &amp; 2\pi k -\omega_0 - \frac{B}{2} &lt; \omega &lt; 2\pi k -\omega_0+\frac{B}{2}\\
  1 &amp; 2\pi k + \omega_0 -\frac{B}{2} &lt; \omega &lt; 2\pi k + \omega_0+\frac{B}{2}\\
  0 &amp; \text{else}
\end{array}
\right.
\]</span> where <span class="math inline">\(\omega_0\in [0,\pi]\)</span> is the and <span class="math inline">\(B &lt; \pi - \omega_0\)</span> is the . The magnitude and phase plot looks like</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig21_3.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Illustration of the ideal bandpass DT filter frequency response.</figcaption>
</figure>
</div>
<p>Finally, notch or bandstop filters remove frequency content inside a band of frequencies (the stop band) defined by the center frequency <span class="math inline">\(\omega_0\in [0,\pi]\)</span> and bandwidth <span class="math inline">\(B &lt; \pi-\omega_0\)</span>. The ideal frequency response is <span class="math display">\[
H\left(e^{j\omega}\right) = \left\{ \begin{array}{lc}
  0 &amp; -\omega_0 - \frac{B}{2} &lt; \omega &lt; -\omega_0+\frac{B}{2}\\
  0 &amp; \omega_0 -\frac{B}{2} &lt; \omega &lt; \omega_0+\frac{B}{2}\\
  1 &amp; \text{else}
\end{array}
\right.
\]</span> with magnitude and phase plot</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig21_4.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Illustration of the ideal bandstop DT filter frequency response.</figcaption>
</figure>
</div>
<p>Often the bandstop filter has a very narrow bandwidth, thus it “notches” out a frequency component of the input signal.</p>
</section>
<section id="practical-filters" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="practical-filters"><span class="header-section-number">21.2</span> Practical Filters</h2>
<p>While ideal CT filters cannot be implemented in practice because they are non-causal, this more nuanced in DT systems. We have to make a distinction between <em>off-line</em> and <em>real-time</em> DT filters. Off-line DT filters, which we will discuss next time, can store as many samples as needed to arbitrarily approximate a non-causal filter, leading to an output that is delayed relative to the input by a significant amount. Real-time filters on the other hand must produce an output <span class="math inline">\(y[n]\)</span> for every input <span class="math inline">\(x[n]\)</span> with no (or short) delay. The distinction is important in some applications, controls in particular, and less so in other areas like audio or video where a delay is not as noticeable. In the remainder of this lecture we assume a real-time filter implementation, which should be causal.</p>
<p>Practical filters are described by a frequency response that is a ratio of two polynomials in <span class="math inline">\(e^{j\omega}\)</span>, i.e. <span class="math display">\[
H\left(e^{j\omega}\right) = \frac{K \cdot\left(e^{j\omega} + b_1\right)\cdot\left(e^{j\omega} + b_2\right)\cdots \left(je^{j\omega} + b_M\right)}{\left(e^{j\omega} + a_1\right)\cdot\left(e^{j\omega} + a_2\right)\cdots \left(e^{j\omega} + a_N\right)}
\]</span> where <span class="math inline">\(K\)</span> is a constant that controls the gain at DC, and the zero or more complex coefficients <span class="math inline">\(b_k\)</span> and the one or more complex coefficients <span class="math inline">\(a_k\)</span> are called the <em>zeros</em> and <em>poles</em> of the filter respectively. Such systems correspond to difference equations as we have covered before and are realizable in real arithmetic if all poles and zeros are real or come in conjugate pairs. The processes of designing DT filters consists of choosing the poles and zeros, or equivalently choosing the coefficients of the numerator and dominator polynomials. This is covered in ECE 3704, ECE 4624, and other upper-level courses.</p>
<p>The general DT frequency response corresponds to a difference equation that when written in recursive form looks like <span class="math display">\[
y[n] = \underbrace{-\frac{c_{N+1}}{c_1} y[n-N] -\frac{c_{N}}{c_1}  y[n-N+1] + \cdots -\frac{c_{2}}{c_1} y[n-1]}_{\text{auto-regressive}} + \underbrace{\frac{d_{N+1}}{c_1} x[n-N] + \frac{d_{N}}{c_1} x[n-N+1] + \cdots + \frac{d_1}{c_1} x[n]}_{\text{moving-average}}
\]</span> The terms corresponding to the weighted sums of previous outputs are called the <em>auto-regressive</em> portion of the filter. The terms corresponding to the weighted sums of previous inputs are called the <em>moving-average</em> portion of the filter.</p>
<p>Filters without auto-regressive terms (<span class="math inline">\(c_i = 0\)</span> for <span class="math inline">\(i &gt; 1\)</span>) are called <em>finite impulse response</em> (FIR) filters, because their impulse response has only a finite number of non-zero values. Filters with auto-regressive terms are called <em>infinite impulse response</em> (IIR) filters, because their impulse response is non-zero for <span class="math inline">\(n &gt; 0\)</span> (although they do approach zero as <span class="math inline">\(n\rightarrow \infty\)</span>).</p>
<p>Practical DT filters differ from the ideal in that they cannot be zero over any finite range of frequencies and cannot transition discontinuously between stop and pass bands. Similar to CT filters, they must vary over the bands and transition smoothly, with a degree of variation and sharpness that is a function of the order of the filter and the exact form of the frequency response polynomials. Thus practical filters are described by additional parameters that define the stop and pass-bands.</p>
<p>The overall gain of the filter is the magnitude of the frequency response at a frequency that depends on the filter type, zero for a low-pass filter and the center frequency for a band-pass filter. The pass-band is defined by the frequency at which the magnitude of the frequency response drops below the overall gain, often -3dB = <span class="math inline">\(\frac{\sqrt{2}}{2}\)</span>. The stop-band is defined similarly, as the frequency at which the magnitude of the frequency response drops further below the overall gain, often -20dB = 0.1 or -40dB = 0.01. The <em>transition bandwidth</em> is defined as the difference in the stop-band and pass-band frequencies. The <em>pass-band ripple</em> is defined as the maximum deviation from the overall gain, over the pass-band. For DT filters, the frequencies are specified in radians per sample. After we discuss sampling we will see how to convert this to an equivalent CT frequency using the sample time.</p>
</section>
<section id="first-order-and-second-order-systems-as-filters" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="first-order-and-second-order-systems-as-filters"><span class="header-section-number">21.3</span> First-order and second-order systems as filters</h2>
<p>Given the equivalence of stable LTI systems and linear, constant-coefficient difference equations, block diagrams, impulse responses, and frequency responses, filters can be represented in any of these ways. We have covered extensively first-order and second-order DT systems and seen how they can be represented variously as state machines, difference equations, block diagrams, and as frequency responses. We now see how they can describe simple filters and serve as building blocks for higher-order filters.</p>
<div class="example">
<div class="example-header">
<p>Example of a first-order DT filter</p>
</div>
<div class="example-container">
<p>Consider a first-order DT system <span class="math display">\[
y[n+1] + ay[n] = b x[n+1]
\]</span> It can be represented as a block diagram</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig21_5.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>First order DT filter as a block diagram.</figcaption>
</figure>
</div>
<p>or as a recursive difference equation [ y[n] = -ay[n-1] + bx[n] ] or as an impulse response [ h[n] = b(-a)^n u[n] ] or as a frequency response if <span class="math inline">\(|a| &lt; 1\)</span> [ H(e^{j}) = = ]</p>
<p>Let us examine two cases, where <span class="math inline">\(a = \tfrac{1}{2}, b=1-a = \tfrac{1}{2}\)</span> and <span class="math inline">\(a = -\tfrac{1}{2}, b=1+a = \tfrac{1}{2}\)</span>. If we plot the frequency response when <span class="math inline">\(a = \tfrac{1}{2}, b=\tfrac{1}{2}\)</span> we see the DC gain is about -9.5 dB, and the response passes through -3dB at <span class="math inline">\(\pm 2.4\)</span> rad/sample. Thus this corresponds approximately to a high-pass filter.</p>
<div id="cell-fig-21-example1_1" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div id="fig-21-example1_1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="See Caption.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-21-example1_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="21-dt-filters_files/figure-html/fig-21-example1_1-output-1.png" alt="See Caption." width="674" height="468" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-21-example1_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.1: Magnitude and phase spectrum for the first-order lowpass filter.
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we plot the frequency response when <span class="math inline">\(a = -\tfrac{1}{2}, b=\tfrac{1}{2}\)</span> we see the DC gain is 0 dB, and the response passes through -3dB at <span class="math inline">\(\pm 0.7\)</span> rad/sample. Thus this corresponds approximately to a low-pass filter.</p>
<div id="cell-fig-21-example1_2" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div id="fig-21-example1_2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="See Caption.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-21-example1_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="21-dt-filters_files/figure-html/fig-21-example1_2-output-1.png" alt="See Caption." width="674" height="468" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-21-example1_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.2: Magnitude and phase spectrum for the first-order lowpass filter.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="example">
<div class="example-header">
<p>Example of a second-order DT filter</p>
</div>
<div class="example-container">
<p>As with CT filters we can increase the sharpness of the filter by increasing the order. Consider a second-order DT system <span class="math display">\[
c_1 y[n+2] + c_2y[n+1] + c_3y[n] = d_1x[n+2] + d_2x[n+1] + d_3x[n]  
\]</span> It can be represented as a block diagram</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig21_6.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Second order DT filter as a block diagram.</figcaption>
</figure>
</div>
<p>or as a recursive difference equation <span class="math display">\[
y[n] = -\frac{c_3}{c_1} y[n-2] - \frac{c_2}{c_1} y[n-1] + \frac{d_3}{c_1} x[n-2] + \frac{d_2}{c_1} x[n-1] + \frac{d_1}{c_1} x[n]
\]</span> or as a frequency response if <span class="math inline">\(|\gamma_i| &lt; 1\)</span> for all <span class="math inline">\(i\)</span> where <span class="math inline">\(\gamma_i\)</span> are the roots of the characteristic equation\ <span class="math inline">\(c_1 E^2 + c_2 E + c_3 = 0\)</span>. <span class="math display">\[
H\left(e^{j\omega}\right) = \frac{d_1 e^{j2\omega} + d_2 e^{j\omega} + d_3}{c_1 e^{j2\omega} + c_2 e^{j\omega} + c_3}
\]</span> As a concrete example, consider this system when c = [<span class="math inline">\(c_1 = 1\)</span>, <span class="math inline">\(c_2 = 0\)</span>, <span class="math inline">\(c_3 = 0.1716\)</span>, <span class="math inline">\(d_1 = 0.2929\)</span>, <span class="math inline">\(d_2 = 0.5858\)</span>, and <span class="math inline">\(d_3 = 0.2929\)</span>. If we plot the frequency response we see the filter gain is 0 dB at DC and passes through -3 dB at approximately <span class="math inline">\(\pm 1.57\)</span> rad/sample. Thus it corresponds to a low-pass filter.</p>
<div id="cell-fig-21-example2" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div id="fig-21-example2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="See Caption.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-21-example2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="21-dt-filters_files/figure-html/fig-21-example2-output-1.png" alt="See Caption." width="662" height="468" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-21-example2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.3: Magnitude and phase spectrum for the second-order lowpass filter.
</figcaption>
</figure>
</div>
</div>
</div>
<p>One thing to note is the attenuation drops off quickly after the passband. This is an advantage of DT filters; they can have small transition bands. Comparing them directly to an equivalent CT filter will have to be deferred until we discuss sampling.</p>
<p>Note the autoregressive part of the filter is to the right of the summations, while the moving average part is to the left. The output of the delay blocks multiplied by non-zero coefficients are called <em>filter taps</em> in signal processing parlance. This repeating structure can be taken advantage of in the creation of general-purpose digital signal processing hardware.</p>
</div>
</div>
<p>We can continue to increase the steepness of the passband to stop-band transitions by increasing the order of the filter. While this can be accomplished using a serial connection of stages as in CT filters, since the implementation of DT filters requires just memory (delay blocks) and adders/multipliers it is common to just implement the filter with a larger number of delay blocks.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./20-ct-filters.html" class="pagination-link" aria-label="Frequency Selective Filters in CT">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Frequency Selective Filters in CT</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./22-dft.html" class="pagination-link" aria-label="Discrete Fourier Transform">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Discrete Fourier Transform</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>